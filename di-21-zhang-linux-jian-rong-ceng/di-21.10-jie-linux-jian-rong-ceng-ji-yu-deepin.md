# Section 21.10 Deepin Compatibility Layer


# Shell script



The script reads as follows:

```sh '
#/bin/sh

Rootdir=/compat/deepin


url= "https://cdimage.deepin.com/WSL/deepin.zip"

"Begin to enter last Deepin Linux..."
"Check motors..."

♪ Check the linux motore
If [ "$(sysrc-n linux_enable)] = "NO"; then
"Linux module should be loaded."
Now, read answer
If you don't mind, case dollar in
[Nn] [OO]| [Nn]
"linux module not loaded"
Exit 1
;
[Yy] [Ee] [S] [Yy]|"]
== sync, corrected by elderman ==
;
That's it.
F
"start linux."
It's not a good idea.

♪ Check dbus
If!
"dbus-daemon not found.
Now, read answer
If you don't mind, case dollar in
[Nn] [OO]| [Nn]
"dbus not mentioned"
Exit 2
;
[Yy] [Ee] [S] [Yy]|"]
Pkg install-y dbus
;
That's it.
F

If ["sysrc-n dbus_enable"]!
"dbus should be able."
Now, read answer
If you don't mind, case dollar in
[Nn] [OO]| [Nn]
"dbus not running"
Exit 2
;
[Yy] [Ee] [S] [Yy]|"]
== sync, corrected by elderman ==
;
That's it.
F
"Start dbus."
It's a service dbus start.

I'm sorry, but I'm sorry.
"unzip not found."
Now, read answer
If you don't mind, case dollar in
[Nn] [OO]| [Nn]
"unzip not contained"
Exit 3
;
*)
Pkg install-y unzip
;
That's it.
F

"now we will Bootstream Deepin."

Fetch $ {url}
mkdir-p {rootdir}
I don't know.
I'm sorry, I'm sorry.
I don't know.
.rm deepin-rootfs.tar

If it's not "YES"
"nullfs should read.
Now, read answer
If you don't mind, case dollar in
[Nn] [OO]| [Nn]
"nulfs not load"
Exit 3
;
[Yy] [Ee] [S] [Yy]|"]
sysrc-f /boot/loader.conf nulls_load=yes
;
That's it.
F

If!
I'm sorry.
Kldload-v Nulls
F

"Mount some fs for linux"
> > ecc/fstab
epho "tmpfs $ {rootdir}/dev/shmtmpfs rw, late, size=1g, Mode=17770" >/etc/fstab
>/etc/fstab
>/etc/fstab
> et ecc/fstab
Echo "/tmp ${rootdir}/tmp Nullfs rw, late 0" >/etc/fstab
#cho "/home {rootdir}/home Nulls rw, late 0" > /etc/fstab
"Mount-al."

"for Deepin Linux, we should change 'compat.linux.
Now, read answer
If you don't mind, case dollar in
[Nn] [OO]| [Nn]
"clos to access"
Exit 4
;
[Yy] [Ee] [S] [Yy]|"]
> / etc/syscl.conf
It's a good time, sysctl compat.linux.osrelease=6.2.10
;
That's it.
"complete!"
echo "to use: chorot $ {rootdir}/bin/bash"
echo"
"I will set back.
"Continue?"
Now, read answer
If you don't mind, case dollar in
[Nn] [OO]| [Nn]
"Set your Deepin by yourself.
Exit 0
;
[Yy] [Ee] [S] [Yy]|"]
>${rootdir}/etc/resolv.conf



Now write applications for Deepin.
"Deb https://com-store-packages.uniontech.com/appstorev23beieappstore" /${rootdir}/etc/apt/sources.list


"I will add i386 for support Wine"
/bin/bash-c "dpkg-add-architecure i386"

chorot {roo/bin/bash-c "apt update &apt upgrad"

"all done."
"Now you can run 'choot /compat/deepin/ bin/bash'Into Deepin"

;
That's it.
````

# Installation shop #

```sh '
#chroot /compat/deepin//bin/bash
Root@ykla:/apt install deepin-app-store
````

Add `/etc/os-version ':

```sh '
[Version]
SystemName=Deepin
SystemName [zh_CN] = Depth operating system
ProjectType=Desktop
ProjectType [zh_CN] = desktop
Edition
EditionName [zh_CN] = Community version (Beta)
MajorVersion = 23
MinorVersion = 23
OsBuild = 21238.100
````

The error is as follows:

```sh '
== sync, corrected by elderman == @elder_man
LibEGL warning:
"dtkwidget" can not find qm files
"depen-home-appstore-client" can not find qm files ("depen-home-appstore-client_C.qm", "depen-home-appstore-client_C.qm")
2023-07-21, 15:55:51.749 [Info] [main.cpp Main 44] ======deepin-app-store ===========8.0.0005”
2023-07-21, 15:55:51.752 [Info] [dbus_manager.cpp DBusManager:::registerDBus45] Failed to review dbus object QDBusError (“org.freedesktop.Dbus.Error.Disconected”), “Not connected to D-Bus server”)
2023-07-21, 15:55:51.752 [Warning] [main.cpp Main 64] DguiApplicationHelper::instance()->setSingleInstance
````

Similar errors are <https://github.com/linuxdeepin/dde-dock/issues/255>
Of these, `libEGL warning: DRI2: failed to ignore ' , as was the case in the original system.

The installation of `deepin-kwin-x11 ' `dde-qt5integration 5 ' `dde-qt5integration ' `deepin-app-store-runtime ' `dde ' is invalid.

If you know what to do, tell us.




# References

<https://github.com/deepin-community/deepin-rootfs>

