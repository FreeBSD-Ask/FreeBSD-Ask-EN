# Section 21.10 Deepin Compatibility Layer


# shell script



The script reads as follows:

```sh
#/bin/sh

rootdir=/compat/deepin


url= "https://cdimage.deepin.com/WSL/deepin.zip"

"Begin to enter last Deepin Linux..."
"check motors..."

♪ check the linux motore
if [ "$(sysrc-n linux_enable)] = "NO"; then
"Linux module should be loaded."
now, read answer
if you don't mind, case dollar in
[Nn] [OO]| [Nn]
"linux module not loaded"
exit 1
;
[Yy] [Ee] [S] [Yy]|"]
== sync, corrected by elderman ==
;
that's it
f
"start linux."
it's not a good idea

♪ check dbus
if
"dbus-daemon not found
now, read answer
if you don't mind, case dollar in
[Nn] [OO]| [Nn]
"dbus not mentioned"
exit 2
;
[Yy] [Ee] [S] [Yy]|"]
pkg install-y dbus
;
that's it
f

if ["sysrc-n dbus_enable"]
"dbus should be able."
now, read answer
if you don't mind, case dollar in
[Nn] [OO]| [Nn]
"dbus not running"
exit 2
;
[Yy] [Ee] [S] [Yy]|"]
== sync, corrected by elderman ==
;
that's it
f
"start dbus."
it's a service dbus start

i'm sorry, but i'm sorry
"unzip not found."
now, read answer
if you don't mind, case dollar in
[Nn] [OO]| [Nn]
"unzip not contained"
exit 3
;
*)
pkg install-y unzip
;
that's it
f

"now we will Bootstream Deepin."

fetch $ {url}
mkdir-p {rootdir}
i don't know
i'm sorry, I'm sorry
i don't know
.rm deepin-rootfs.tar

if it's not "YES"
"nullfs should read
now, read answer
if you don't mind, case dollar in
[Nn] [OO]| [Nn]
"nulfs not load"
exit 3
;
[Yy] [Ee] [S] [Yy]|"]
sysrc-f /boot/loader.conf nulls_load=yes
;
that's it
f

if
i'm sorry
kldload-v nulls
f

"mount some fs for linux"
> > ecc/fstab
epho "tmpfs $ {rootdir}/dev/shmtmpfs rw, late, size=1g, mode=17770" >/etc/fstab
>/etc/fstab
>/etc/fstab
> et ecc/fstab
echo "/tmp ${rootdir}/tmp nullfs rw, late 0" >/etc/fstab
#cho "/home {rootdir}/home nulls rw, late 0" > /etc/fstab
"mount-al."

"for Deepin Linux, we should change 'compat.linux
now, read answer
if you don't mind, case dollar in
[Nn] [OO]| [Nn]
"clos to access"
exit 4
;
[Yy] [Ee] [S] [Yy]|"]
> / etc/syscl.conf
it's a good time, sysctl compat.linux.osrelease=6.2.10
;
that's it
"complete!"
echo "to use: chorot $ {rootdir}/bin/bash"
echo"
"I will set back
"Continue?"
now, read answer
if you don't mind, case dollar in
[Nn] [OO]| [Nn]
"Set your Deepin by yourself
exit 0
;
[Yy] [Ee] [S] [Yy]|"]
>${rootdir}/etc/resolv.conf



now write applications for Deepin
"deb https://com-store-packages.uniontech.com/appstorev23beieappstore" /${rootdir}/etc/apt/sources.list


"I will add i386 for support Wine"
/bin/bash-c "dpkg-add-architecure i386"

/bin/bash-c "apt update & apt upgrad"

    echo "all done."
    echo "Now you can run '#chroot /compat/deepin/ /bin/bash' Into Deepin"

;
that's it
````

# Installation shop #

```sh
#chroot /compat/deepin/ /bin/bash
root@ykla:/# apt install deepin-app-store
```

ADD __CODESPAN_0_:

```sh
[Version] 
SystemName=Deepin
SystemName[zh_CN]=深度操作系统
ProductType=Desktop
ProductType[zh_CN]=桌面
EditionName=Community
EditionName[zh_CN]=社区版(Beta)
MajorVersion=23
MinorVersion=23
OsBuild=21238.100
```

The error is as follows:

```sh
================== 程序启动 ================== QTime("15:55:50.305")
libEGL warning: DRI2: failed to authenticate
"dtkwidget" can not find qm files ("dtkwidget_C.qm", "dtkwidget_C.qm")
"deepin-home-appstore-client" can not find qm files ("deepin-home-appstore-client_C.qm", "deepin-home-appstore-client_C.qm")
2023-07-21, 15:55:51.749 [Info] [main.cpp             main                                44] =========deepin-app-store version========= "8.0.0.0005"
2023-07-21, 15:55:51.752 [Info] [dbus_manager.cpp     DBusManager::registerDBus           45] Failed to register dbus object QDBusError("org.freedesktop.DBus.Error.Disconnected", "Not connected to D-Bus server")
2023-07-21, 15:55:51.752 [Warning] [main.cpp             main                                64] DGuiApplicationHelper::instance()->setSingleInstance
```

similar errors are <https://github.com/linuxdeepin/dde-dock/issues/255>
OF WHICH CODESPAN_0 CAN BE IGNORED, AS IN THE ORIGINAL SYSTEM。

THE INSTALLATION OF __CODESPAN_0 __ CODESPAN_1 __ CODESPAN_2 _ __ CODESPAN_3 __ __ CODESPAN_4 __ IS INVALID。

If you know what to do, tell us。




# References

<https://github.com/deepin-community/deepin-rootfs>

