# SECTION 17.3 PHP 8.X

# INSTALL PHP

> ** Note**
>
> There is a conflict between different PHP modules, which will result in the production of ports, and do not try to select all PHP plugin options. Pkg is therefore recommended for installation。

```sh
# pkg install php84 php84-extensions mod_php84
```

Or..

```
# cd /usr/ports/lang/php84/ && make install clean
# cd /usr/ports/lang/php84-extensions/ && make install clean
# cd /usr/ports/www/mod_php84 && make install clean
```

- VIEW PHP VERSION:

```sh
root@ykla:~ # php -v
PHP 8.4.4 (cli) (built: Feb 15 2025 01:05:08) (NTS)
Copyright (c) The PHP Group
Zend Engine v4.4.4, Copyright (c) Zend Technologies
```

> ** Note**
>
THIS NUMBER WILL CHANGE. YOU CAN FIRST SEE HOW MUCH OF THE CURRENT VERSION IS INSTALLED。
>
> ```sh '
>root@ykla: #pkg search-o lang/php
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php81 PHP Scripting Language (8.1.X Branch)
>lang/php81-expensions "meta-port" to include PHP extensions
>lang/php82 PHP Scripting Language (8.2.X Branch)
>lang/php82-extensions "meta-port" to include PHP extensions
>lang/php83 PHP Scripting Language (8.3.X Branch)
>lang/php83-extensions "meta-port" to include PHP extensions
>lang/php84 PHP Scripting Language (8.4.X brnch)
>lang/php84-extensions "meta-port" to include PHP extensions (8.4.X brancy)
> ````

PHP'S EXAMPLE FILE AT __CODESPAN_0_。

```sh
root@ykla:~ # cp -v /usr/local/etc/php.ini-production /usr/local/etc/php.ini
/usr/local/etc/php.ini-production -> /usr/local/etc/php.ini
```

- Start-up services:

```
root@ykla:~ # service php_fpm enable
php_fpm enabled in /etc/rc.conf
root@ykla:~ # service php_fpm start
Performing sanity check on php-fpm configuration:
[25-Feb-2025 20:28:32] NOTICE: configuration file /usr/local/etc/php-fpm.conf test is successful
Starting php_fpm.
root@ykla:~ # service php_fpm status
php_fpm is running as pid 2592.
```

- View post-installation information:

```sh
root@ykla:~ # pkg info -D mod_php84
mod_php84-8.4.4_1:
On install:
******************************************************************************

Consider switching to pp-fpm and mod_fast_cgi as per Apache httpd project
see https://cwiki.apache.org/confluence/display/HTTPD/PHP-FPM
It is recommended to switch to php-fpm and mod_fast_cgi, as recommended by the Apache httpd project. For further information, see https://cwiki.apache.org/confluence/display/HTTPD/PHP-FPM

*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***

If you are building PHP-based reports in poudriere (8) or Synth with ZTS capable,
i'm sorry to bother you, but I'm sorry.
Add WITH_MPM=event to /etc/make.conf if you build a PHP base port with ZTS enabled in poudriere (8) or Synd。

*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***

Make sure inex.php is part of your Directory Index.
Make sure that index.php is part of Directory Index。

You should add the following to your Apache configration file:
You should add the following to your Apache profile:

FilesMatch ".php"
Sethandler application/x-httpd-php
</FilesMatch >
"FilesMatch"
Sethandler application/x-httpd-php-source
</FilesMatch >

*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
````

# # References

- [Install PHP 8.0 on FreeBSD 13 / FreeBSD 12] (https://publicforgeeks.com/how-to-install-php-8-on-freebsd-system/)
- [PHP-FPM (8)] (https://man.freebsd.org/cgi/man.cgi?query=php-fpm), man page
- [Apache and PHP] (https://forums.freebsd.org/threads/apache-and-php.80625/) with hint to install __CODESPAN_0_

# Configure Apache

EDIT __CODESPAN_0_:

```php
<FilesMatch "\.php$">
    SetHandler application/x-httpd-php
</FilesMatch>
<FilesMatch "\.phps$">
    SetHandler application/x-httpd-php-source
</FilesMatch>
```

EDIT __CODESPAN_0_, ADD:

```php
<?php
    phpinfo();
?>
```

Restart service:

```sh
# service php_fpm restart
# service apache24 restart
```

VISIT __CODESPAN_0, E.G. __CODESPAN_1_:

[Apache PHP8 FreeBSD] (..gitbook/assets/php1.p.png)

References

- [Install PHP 8.0 on FreeBSD 13 / FreeBSD 12] (https://publicforgeeks.com/how-to-install-php-8-on-freebsd-system/)

# Configure Nginx

- EDIT __CODESPAN_0:

DELETE ALL __CODESPAN_0_:

```ini
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}
```

and amend to read as follows:

```ini
        location ~ \.php$ {
            root           /usr/local/www/nginx; # 注意修改此处变成这样
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name; # 注意修改此处变成这样，$document_root 即网站路径
            include        fastcgi_params;
        }
```

- EDIT __CODESPAN_0_, ADD

```php
<?php
    phpinfo();
?>
```

- Restart service:

```
root@ykla:~ # service php_fpm restart
Performing sanity check on php-fpm configuration:
[25-Feb-2025 20:59:12] NOTICE: configuration file /usr/local/etc/php-fpm.conf test is successful
Starting php_fpm.
root@ykla:~ # service nginx restart
Performing sanity check on nginx configuration:
nginx: the configuration file /usr/local/etc/nginx/nginx.conf syntax is ok
nginx: configuration file /usr/local/etc/nginx/nginx.conf test is successful
Stopping nginx.
Waiting for PIDS: 1153.
Performing sanity check on nginx configuration:
nginx: the configuration file /usr/local/etc/nginx/nginx.conf syntax is ok
nginx: configuration file /usr/local/etc/nginx/nginx.conf test is successful
Starting nginx.
```

VISIT __CODESPAN_0, E.G. __CODESPAN_1_:

[Apache PHP8 FreeBSD] (..getbook/assets/php2.png)

References

- [How to Install PHP and PHP-FPM on FreeBSD 14.0] (https://docs.vultr.com/how-to-install-php-and-php-fpm-on-freebsd-14-0). The main reference here
