# Section 17.3 PHP 8.X

# Install PHP

> ** Note**
>
> There is a conflict between different PHP modules, which will result in the production of ports, and do not try to select all PHP plugin options. Pkg is therefore recommended for installation.

```sh '
# pkg install php84 php84-extensions mod_php84
````

Or...

````
#cd /usr/ports/lang/php84/ & make install clean
#cd /usr/ports/lang/php84-extensions/ & make install clean
# cd /usr/ports/www/mod_php84 & make important
````

- View PHP version:

```sh '
#php-v
PHP 8.4.4 (cli) (built: Feb 15 2025 01:05:08) (NTS)
Copyright (c) The PHP Group
Zend Engineering v.4.4, Copyright (c) Zend Technologies
````

> ** Note**
>
This figure is subject to change. `pkg search-o lang/php ' to see how much of the current version is installed.
>
> ```sh '
>root@ykla: #pkg search-o lang/php
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php-mode.el PHP Mode for GNU Emacs
>lang/php81 PHP Scripting Language (8.1.X Branch)
>lang/php81-expensions "meta-port" to include PHP extensions
>lang/php82 PHP Scripting Language (8.2.X Branch)
>lang/php82-extensions "meta-port" to include PHP extensions
>lang/php83 PHP Scripting Language (8.3.X Branch)
>lang/php83-extensions "meta-port" to include PHP extensions
>lang/php84 PHP Scripting Language (8.4.X brnch)
>lang/php84-extensions "meta-port" to include PHP extensions (8.4.X brancy)
> ````

PHP's example document is in `/usr/local/etc/php.ini-project'.

```sh '
Root@ykla: #cp-v/usr/local/etc/php.ini-project/usr/local/etc/php.ini
/usr/local/etc/php.ini-prevention - /usr/local/etc/php.ini
````

- Start-up services:

````
# service php_fpm capable
php_fpm enabled in/etc/rc.conf
# service php_fpm start
Checking on php-fpm configuration:
[25-Feb-2025 20:28:32] NOTICE: configration file/usr/local/etc/php-fpm.conf test is relevant
Starting php_fpm.
Root@ykla:
Pp_fpm is running as pid 2592.
````

- View post-installation information:

```sh '
root@ykla: ~ #pkginfo-Dmod_php84
Mod_php84-8.4_1:
On install:
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***

Consider switching to pp-fpm and mod_fast_cgi as per Apache httpd project
See https://cwiki.apache.org/confluence/display/HTTPD/PHP-FPM
It is recommended to switch to php-fpm and mod_fast_cgi, as recommended by the Apache httpd project. For further information, see https://cwiki.apache.org/confluence/display/HTTPD/PHP-FPM

*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***

If you are building PHP-based reports in poudriere (8) or Synth with ZTS capable,
I'm sorry to bother you, but I'm sorry.
Add WITH_MPM=event to /etc/make.conf if you build a PHP base port with ZTS enabled in poudriere (8) or Synd.

*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***

Make sure inex.php is part of your Directory Index.
Make sure that index.php is part of Directory Index.

You should add the following to your Apache configration file:
You should add the following to your Apache profile:

FilesMatch ".php"
Sethandler application/x-httpd-php
</FilesMatch >
"FilesMatch"
Sethandler application/x-httpd-php-source
</FilesMatch >

*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
````

# # References

- [Install PHP 8.0 on FreeBSD 13 / FreeBSD 12] (https://publicforgeeks.com/how-to-install-php-8-on-freebsd-system/)
- [PHP-FPM(8)] (https://man.freebsd.org/cgi/man.cgi?query=php-fpm), man page
- [Apache and PHP] (https://forums.freebsd.org/threads/apache-and-php.80625/) with the suggestion to install `mod_php84'

# Configure Apache

Edit `/usr/local/etc/apache24/Includes/php.conf':

``php '
FilesMatch ".php"
Sethandler application/x-httpd-php
</FilesMatch >
"FilesMatch"
Sethandler application/x-httpd-php-source
</FilesMatch >
````

Edit `/usr/local/www/apache24/data/info.php ' , add:

``php '
What's wrong?
phpinfo();
♪ That's it ♪
````

Restart service:

```sh '
# Service php_fpm current
# Service apace24 present
````

Visit `ip/info.php ' , e.g. `http://192.168.179.150/info.php ' :

[Apache PHP8 FreeBSD] (..gitbook/assets/php1.p.png)

References

- [Install PHP 8.0 on FreeBSD 13 / FreeBSD 12] (https://publicforgeeks.com/how-to-install-php-8-on-freebsd-system/)

# Configure Nginx

- Edit `/usr/local/etc/nginx/nginx.conf ' :

Delete all ##:

```ini '
#location ~.php {
# root html;
# fastcgi_pass127.0.0.1:9,000;
# Fastcgi_index index.php;
#fastcgi_param SCRIPT_FILANAME/scripts$fastcgi_script_name
# include pastcgi_params;
♪ I don't know ♪
````

and amend to read as follows:

```ini '
Local
Note to change this to this
Fastcgi_pass 127.0.0.1:9,000;
-Fastcgi_index index.php;
Fastcgi_param SCRIPT_FILANAME $document_root$fastcgi_script_name; # Note to change this to $document_root, the web path
Include pastcgi_params;
♪ I'm sorry ♪
````

- Edit `/usr/local/www/nginx/info.php ' , add

``php '
What's wrong?
phpinfo();
♪ That's it ♪
````

- Restart service:

````
# service php_fpm current
Checking on php-fpm configuration:
[25-Feb-2025 20:59:12] NOTICE: configuration file/usr/local/etc/php-fpm.conf test is relevant
Starting php_fpm.
Root@ykla:
Check on nginx configuration:
nginx: the communication file/usr/local/etc/nginx/nginx.conf syntax is ok
nginx: conversion file/usr/local/etc/nginx/nginx.conf test is relevant
Stopping nginx.
Waiting for PIDS: 1153.
Check on nginx configuration:
nginx: the communication file/usr/local/etc/nginx/nginx.conf syntax is ok
nginx: conversion file/usr/local/etc/nginx/nginx.conf test is relevant
Starting.
````

Visit `ip/info.php ' , e.g. `http://192.168.179.150/info.php ' :

[Apache PHP8 FreeBSD] (..getbook/assets/php2.png)

References

- [How to Install PHP and PHP-FPM on FreeBSD 14.0] (https://docs.vultr.com/how-to-install-php-and-php-fpm-on-freebsd-14-0). The main reference here
