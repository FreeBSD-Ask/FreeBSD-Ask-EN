# Section 17.11 MongoDB 80

# Install

```sh
# pkg ins mongodb80
```

Or:

```sh
# cd /usr/ports/databases/mongodb80/ 
# make install clean
```

See after installation to describe:

```sh
root@ykla:~ # pkg info -D mongodb80
mongodb80-8.0.4_3:
On install:
MongoDB on Raspberry Pi can work but is unsupported upstream.
Please read https://jira.mongodb.org/browse/SERVER-71772 and enable option
ARMV80A if you run this on a non-LSE ARM cpu like Raspberry Pi 4.
# MongoDB 在 Raspberry Pi 上可以运行，但官方不支持。
# 请阅读 https://jira.mongodb.org/browse/SERVER-71772 并在 Raspberry Pi 4 等非 LSE ARM CPU 上启用 ARMV80A 选项。

MongoDB 6.0 and up do not include the 'mongo' CLI shell anymore
i'm going to use the MongoDB Shell.
# MongoDB 6.0 and beyond no longer include 'mongo' CLI shell。
# You can use MongoDB Shell (https://github.com/mongodb-js/mongosh)。

# pkg install npm
$ npm install mongosh
$npxmongoshmongodb://127.0.0.1:27017/
# install npm and install mongosh with the following command:
♪ $npm install mongosh
# Then use npx to start a mogosh connection to the local MongoDB instance:
# $npxmongoshmongodb
````

Services

```sh
root@ykla:~ # service mongod enable
mongod_enable:  -> YES
root@ykla:~ # service mongod start
Starting mongod.
```

# Mongosh

The Ports source has a mongosh, which does not require additional operation。

# install mongosh

```sh
# pkg install mongosh
```

Or:

```sh
# cd /usr/ports/databases/mongosh/
# make install clean
```

# # Test Link MongoDB

```sql
root@ykla:~ # mongosh mongodb://127.0.0.1:27017/
Current Mongosh Log ID:	67bca91ccf5bbd1a232d5665
Connecting to:		mongodb://127.0.0.1:27017/?directConnection=true&serverSelectionTimeoutMS=2000&appName=mongosh+2.2.5
Using MongoDB:		8.0.4
Using Mongosh:		2.2.5

For mongoshinfo see: https://docs.mongodb.com/mongodb-shell/


To help protect our policies, anonymous usage data is collected and sent to MongoDB periodically (https://www.mongodb.com/legal/privacy-policy).
You can open-out by running the disable Telemetry.

-
The service created these startup wars when shooting
Access control is not available for the data
-

♪ test ♪
````

# Profile

The MongoDB 80 configuration file is at ___CODESPAN_0, and the configuration template is at __CODESPAN_1。


# Create user and password



```sql
root@ykla:~ # mongosh mongodb://127.0.0.1:27017/
Current Mongosh Log ID:	67bcb0e5337ba1c7d62d5665
Connecting to:		mongodb://127.0.0.1:27017/?directConnection=true&serverSelectionTimeoutMS=2000&appName=mongosh+2.2.5
Using MongoDB:		8.0.4
Using Mongosh:		2.2.5
mongosh 2.4.0 is available for download: https://www.mongodb.com/try/download/shell

For mongoshinfo see: https://docs.mongodb.com/mongodb-shell/

♪ and i'll be back ♪
dmin 180.00 KiB
config 92.00 KiB
local 72.00 KiB
test> use admin/ / use database admin and you can create a new database
switched to db admin
dmin> db.createUser({/ / / Note...) is automatically generated
...user: 'admin', // custom username
...pwd: 'z', // custom password, here i set the password to z
...rolls: [ chuckles ]
...role: 'root', / / using a superman who manages all databases with maximum access
... db: 'admin '// assign database
♪ ... ♪
...)
{ok: 1}
admin>quit/ / quit
````

You can copy directly the following text into the command line:

```sql
db.createUser({ 
   user: 'admin',    
   pwd: 'z', 
   roles:[{
     role: 'root',   
     db: 'admin'   
   }]
 })
```

Then turn on the password:

EDIT __CODESPAN_0_:

DELETE __CODESPAN_0 AND ADD __CODESPAN_2 IN THE FOLLOWING ROW, I.E.:

```ini
security:
  authorization: enabled
```

Restart service:

```sh
# service mongod restart
```


# Login

# # Login 1

```sql
root@ykla:~ # mongosh mongodb://127.0.0.1:27017/
Current Mongosh Log ID:	67bcb1bafa0080a2132d5665
Connecting to:		mongodb://127.0.0.1:27017/?directConnection=true&serverSelectionTimeoutMS=2000&appName=mongosh+2.2.5
Using MongoDB:		8.0.4
Using Mongosh:		2.2.5
mongosh 2.4.0 is available for download: https://www.mongodb.com/try/download/shell

For mongoshinfo see: https://docs.mongodb.com/mongodb-shell/

test> use admin / / must specify database admin
switched to db admin
db. auth ('admin', 'z') // login database
{ok: 1}
@admin
````

# # Login 2

```sql
root@ykla:~ # mongosh -u admin -p z
Current Mongosh Log ID:	67bcb200cbc3b601fb2d5665
Connecting to:		mongodb://<credentials>@127.0.0.1:27017/?directConnection=true&serverSelectionTimeoutMS=2000&appName=mongosh+2.2.5
Using MongoDB:		8.0.4
Using Mongosh:		2.2.5
mongosh 2.4.0 is available for download: https://www.mongodb.com/try/download/shell

For mongoshinfo see: https://docs.mongodb.com/mongodb-shell/

♪ test ♪
````

# References

- [PHP7] (https://youuser.me/%E5%AE%9D%E1%E1%E9%E9%E9%E9%A2%E6%E9%D%BF-%E4%BD%E7%94%A8mongodb%E4%B8%E4%E4%E4%BA%9B%E6%95%E7%A8%B-php7.html)
- [mongodb add administrator and user] (https://chenyejun.github.io/blog/mongoDB/mongodbAddUser.html)
