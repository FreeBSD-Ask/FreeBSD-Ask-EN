# Section 17.13 Cady

# Install

```sh '
♪ Pkg in caddy
````

or

```sh '
#cd/usr/ports/www/caddy/
# Make install clean
````

# View installation configuration

```sh '
Root@ykla:
root@ykla:
caddy-2.9.1:
On install:
To ready caddy:
# Enable Cady:

- Edit/usr/local/etc/caddy/Cadyfile
See https://caddyserver.com/docs/
# - Edit /usr/local/etc/caddy/Cadyfile
# See https://caddyserver.com/docs/ Get More Profile

- Run'service caddy enough.
# - Run 'servicecaddy available' to enable the Cady service to start automatically on system startup

Not while Cady historically deals to run as root: how well, it is long-standing
I'm sorry, but I'm sorry, but I'm sorry.
# Note that while Cady currently defaults to run as root:wheel, it is strongly recommended to run as a non-privileged user such as www:www.

- Use security/portacl-rc to make it work.
# - Use security/portacl-rc to enable privileged port binding:

# pkg install security/portacl-rc
# Sysrc portacl_users+ #www
# Sysrc portacl_user_www_tcp=https
# Sysrc portacl_user_www_udp= "https"
♪ service portacl enough
♪ service portacl start
# These commands install and enable portacl port access controls, allowing unprivileged users (e. g. www) to bind HTTP and HTTPS ports

- CONFIGURE Cady to run as:
# - Configure Cady running as www:www user

#Sysrc Cady_user #
# Use this command to configure Cady to run by www:www user and group

- Not if Cady has been started as root strictly in
/var/log/caddy, /var/db/caddy, and /var/run/caddy may require their ownship
I'm going to have to change.
# Note that if Cady had started as root, the documents in /var/log/caddy, /var/db/caddy and /var/run/caddy may need to change ownership of the document manually.

/usr/local/etc/rc.d/caddy has the following instructions:
#/usr/local/etc/rc.d/caddy default configuration as follows:

- Server log: /var/log/caddy/caddy.log
(runtime messages, NOT an access.log)
# - Server log: /var/log/caddy/caddy.log
# This file contains running-time log information rather than access log

- Automatic SSL curtificate status: /var/db/caddy/data/caddy/
# - Automatic SSL certificate storage location: /var/db/caddy/data/caddy/

-Adminization endpoint: /unix/var/run/caddy/caddy.sock
# - Manage Endpoints@unix/var/run/caddy/caddy.sock
# Management interface access via Unix

- Runs as root: wheel (this will change to www: in the future)
# - Currently run as root:wheel user by default, with future changes to www:www user identity

On upward from cady<23.0:
The default settlements for cady runtime files have changed!
# Upgrade from caddy< 2.3.0:
# Cady Runtime file default location changed!

- Caddy's runtime log is now/var/log/caddy/caddy.log.
(was / var/log/caddy.log)
# - Caddy Runtime Log is now in / var/log/caddy/caddy.log (formerly / var/log/caddy.log)

- Automatic SSL tables are now stopped in /var/db/caddy/data/caddy
(was / root/.local/share/caddy)
# - Automatic SSL certificates are now stored in /var/db/caddy/data/caddy (formerly / root/. local/share/caddy)

- Configuration atosaves are now stopped in /var/db/caddy/config/caddy
(was / root/.config/caddy)
# - Configure AutoSaving is now stored in / var/db/caddy/config/caddy (formerly / root/.config/caddy)

See/usr/local/etc/rc.d/caddy
# You can change these default settings. See /usr/local/etc/rc.d/caddy for more information

On upgrade from cady<2.7.4_2:
The default Cady administration endpoint location has been changed from
Localhost: 2019 to a protected Unix domain
/var/run/caddy/caddy.sock
# Upgrade from caddy < 2.7.4_2:
# The default Cady management endpoint position has been changed from localhost:2019 to a protected Unix domain package,
# In / var/run/caddy/caddy.sock

This can be overrided with the `caddy_admin ' rc variable, or by specifying
In the Cadyfile `admin ' section, documented here:
# This can be covered by the `caddy_admin ' rc variable, or specified in the `admin ' section of the Cadyfile, for more details see here:

https://caddyserver.com/docs/caddyfile/options#admin

The previous decision, partly paid with the service running as root,
You know, maybe have serious security problems for sharing machines with untrusted
I'm sorry, sir.
# Previous default settings, especially when used with root identity, may pose serious security risks to shared machines, especially in untrusted user environments.

On upward:
It is STRONGLY RECOMMENDED TO RUN Cady as an unprivileged user, such as
www, rather than the current default of root: wheel.
# Uptime:
# Strongly recommends that Cady run as a non-privileged user, e. g. www:www, not the current default root:wheel.

If you have received upon earlier sentences:
# If you rely on early default settings:

- Use security/portacl-rc to make it work.
# - Enable privileged port binding with security/portacl-rc:

# pkg install security/portacl-rc
# Sysrc portacl_users+ #www
# I don't know"https"
# Sysrc portacl_user_www_udp= "https"
♪ service portacl enough
♪ service portacl start
# Install and configure portacl to allow unprivileged users (e. g. www) to bind HTTP and HTTPS ports

- Stop the server, and update owners on Cady runtime files:
# - Stop the server and update the Caddy running time file ownership:

♪ service caddy stop
#down -R www:www.var/db/caddy/var/log/caddy/var/run/caddy
# Stop the Cady service and change ownership of the file to www:www user

The other changes may be important depending on your exact Cady
I don't know what you're talking about.
# Based on your Cady configuration, there might be other changes.

- Change the default runtime user, and restart the server:
# - Change the default running time user and restart the server:

#Sysrc Cady_user #
♪ Service caddy start
# Use this command to change the running time user and group of Caddy to www:www, and restart the Caddy service
````

Configure

Note**
>
> Error due to the inability of non-privileged users to open the 443 port `listen tcp:443: bind: permission denied ' .

Install the above-mentioned `security/portacl-rc ':

```sh '
# pkg install security/portacl-rc
# Sysrc portacl_users+ #www
# Sysrc portacl_user_www_tcp=https
# Sysrc portacl_user_www_udp= "https"
♪ service portacl enough
♪ service portacl start
````

Configure services:

```sh '
♪ service caddy able ♪
♪ service caddy start ♪
♪ service caddy stop ♪
#Sysrc Cady_user #
#down -R www:www.var/db/caddy/var/log/caddy/var/run/caddy
````

New Test Page:

```sh '
#mkdir-p/usr/local/www/caddy/
````

Edit `/usr/local/www/caddy/index.html ' to read:

```html
Doctype html
♪ html lang ♪
♪ Head ♪
"UTF-8"
{\cHFFFFFF}{\cH00FFFF} {\cHFFFFFF}{\cH00FFFF} {\cHFFFFFF}{\cH00FFFF} {\cHFFFFFF}{\cH00FFFF} {\cHFFFFFF}{\cH00FFFF} {\cHFFFFFF}{\cH00FFFF}{\cH00FFFF}
Welcome to the Chinese Community! </title >
</head>
Hey, buddy.
"h1 style ="text-align: center; "hello World!
</body >
</html>
````

````
Root@ykla:
Starting caddy... done.
Log: /var/log/caddy/caddy.log
````

`https://localhost/ ':

[Cady FreeBSD] (..gitbook/assets/caddy1.png)

References

- [Caddy Installes and Use the Academy] (https://blog.ovvv.top/posts/f3ac7ef6/), HTML from this test page

