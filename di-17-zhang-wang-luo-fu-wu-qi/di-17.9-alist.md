# Section 17.9


- Functional request: make it Port.

# Install

# Official binary package

```sh '
# mkdir alist
♪ cd alist
#fetch https://github.com/AlistGo/alist/releases/download/v3.39.2/alist-freebsd-amd64.tar.gz
#tar zxvf alist-freebsd-amd64.tar.gz
#rm alist-freebsd-amd64.tar.gz
````

Note**
>
>There is no need for additional rear-alist-web configuration based on the description and actual test of [manual installation] (https://alist.nn.ci/zh/guide/install/manual.html).

# # compile installation (optional)


Installation dependency:

```sh '
# pkg install give go
````

Or...

```sh '
#cd /usr/ports/devel/git/ & make install clean
#cd /usr/ports/lang/go/ & make install clean
````

Then:

```sh '
#get line -b v3.38.0 https://github.com/alist-org/alist#
# cd alist/public
#fetch https://github.com/AlistGo/alist-web/releases/download/3.38.0/dist.tar.gz # This is the front-end component, which has been compiled by the official, and which corresponds to the back-end version
# tar xzvf dist.tar.gz # discompress
# rm dist.tar.gz # clean the garbage
♪ cd...
````


```bash
# Mkdir built
# cd built
♪ Go build-ldflags ♪
````

The compiled document is under `build ' .


# Deployment rc service

# # Write `/usr/local/etc/rc.d/alist'

`ee /usr/local/etc/rc.d/alist ' :

```sh '
#!/bin/sh
.../etc/rc.subr

Name = "alist"
"alist_enable"
Common_path=/home/ykla/alist/build
command=$${command_path}/alist# command path
Command_args= "start"
Stop_cmd=do_stop# Stop command parameters

Do_stop()
_Other Organiser
Stop
♪ I'm sorry ♪

load_rc_config $name#Variments defined in rc.conf files
: ${alist_enable:=no} # Sets no if no list_enable is set
Run_rc_compand "$1" #run service command
````

Increase enforcement authority

```sh '
#chmod +x/usr/local/etc/rc.d/alist
````


# # Use alist service

```sh '
# Sysrc alist_enable
````

Enhance security by using common user to execute the process (note that the owner and group of `build ' directories must be `ykla ' ):

```sh '
# Sysrc alist_user=ykla
````

Initialization Option I

```sh '
Root@ykla:/home/ykla/alist/build#./alist admin
INFO [2024-10-29 12:02:04]
INFO (2024-10-29 12:02:04) config file not available, creating default config file
INFO [2024-10-29 12:02:04) load config from env with prefix: ALIST_
INFO (2024-10-29 12:02:04) init logrus...
INFO [2024-10-29 12:02:04]
INFO [2024-10-29 12:02:04) Admin user's username: admin
The password can only be output at the first start, and then started as a Hash value, which cannot be reversed
IFO [2024-10-29 12:02:04)
INFO [2024-10-29 12:02:04] You can also set a new password by running [alist admin set NEW_PASSWORD]
````

```sh '
#service alist start
Starting alist.
INFO [2024-10-29 12:07:25]
````

# # Initialization option II

```sh '
♪ service alist start ♪
Starting alist.
INFO [2024-10-28 22:43.45]
♪ service alist stop ♪
Stomping alist.
Wait for PDIS: 3436.
# Rm-rf daemon #
# ps # check if there's an alist, kill it, if you can't skip the next step
# Kill 3436
````

Reset the `admin ' password to `1 ' and must specify an absolute path to change the password:

```sh '
# .../alist admin set 1-data/home/ykla/alist/build/data
````

Restart service:

````
# Service alist start
````

# Login #

`http://ip:5244 ' , please replace `ip ' with your LAN address. The user name is `admin ' .

[Alist in FreeBSD]


References

- [alist specifies --data runs inactive] (https://github.com/AlistGo/alist/issues/2580).
- Also [starts and so forth] (https://alist.nn.ci/zh/guide/install/manual.html#%E5%AE%88%E6%A%A4%E8%BF%9B%E7%A8%B) will force `-force-bin-dir'. Any `data ' designation for `start ' will be accompanied by `-force-bin-dir ' . But it's still not working.

# Specify vlc as an external player for Alist

The embedded player in the Alist sometimes cannot play certain videos, but Alist can call external programs (through `xdg-open ') via URI. Alist specified a video address for vlc as `vlc://http://xxx', provided that a vlc program is specified for `vlc://`URI at the beginning.

Install vlc:

```sh '
# pkg install vlc
````

Or:

```sh '
#cd/usr/ports/multimedia/vlc/
# Make install clean
````

`xdg-open 'transmits URI to vlc will contain `vlc:// ', vlc cannot open such an address, needs to be removed before opening the video address and then call vlc, and the following is a script to call:

```sh '
Safreya ~ %cat ~ /.local/share/applications/vlc-noschema.sh
#!/bin/sh
url = $1
# Remove vlc://headvlc "$clean_url"
````

Increase enforcement authority

```sh '
$chmod u+x ~ .local/share/applications/vlc-noschema.sh
````

New `.desktop ' file for xdg-open to call on the script above:

```sh '
safreya ~ %cat ~/.local/share/applications/userapp-vlc.desktop
[Desktop Entry]
Encoding=UTF-8
Version = 1.0
Type=Application
Nodisplay=true
Exec=/home/safreya/.local/share/applications/vlc-noschema.sh %U
Name =vlc
Comment=Custom definition for vlc
````

Register `vlc://`URI 'caller

```sh '
US$ update-desktop-database~/.local/share/applications
$ xdg-mime default user-vlc.desktop x-scheme-handler/vlc
````

# References

- [ansoncloud8/am-alist-freebsd] (https://github.com/ansoncloud8/am-alist-freebsd/blob/main/.github/workflows/build.yml)
- [Run from source code] (https://alist.nn.ci/zh/guide/install/source.html), official document
