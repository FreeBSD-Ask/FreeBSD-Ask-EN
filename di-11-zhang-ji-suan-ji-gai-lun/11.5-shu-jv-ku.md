# Section 11.5 MySQL Database

# UNIX CONNECT TO DATABASE, EXECUTE SQL SCRIPT

```sh
# mysql -u root -p
# source FileName.sql
```

# Create a database

```sql
create database db_name;
```

-_CODESPAN_0_: DATABASE NAME

Database names are case-sensitive, with a maximum of 64 characters, with a maximum of 256 characters, and no database keyword can be used。

Rename Database

```sql
rename database old_name to new_name;
```

-_CODESPAN_0_: OLD DATABASE NAME
-__CODESPAN_0_: NEW DATABASE NAME


# View the database

```sql
show databases;
```


# Into the database

```sql
use db_name;
```

-_CODESPAN_0_: DATABASE NAME

# Delete the database

```sql
drop database db_name;
```

-_CODESPAN_0_: DATABASE NAME

# Change database character set

```sql
alter database xxx
default character set UTF-8;
```

# SQL DATA TYPE

-_CODESPAN_0(1B),_CODESPAN_1_(2B),_CODESPAN_2_(3B),_CODESPAN_3_ (4B),_CODESPAN_4_ (8B)
-_CODESPAN_0(4B),_CODESPAN_1(8B),_CODESPAN_2_
- __CODESPAN_0 IS THE CHARACTER TYPE AND WANTS TO SAVE THE STRING __CODESPAN_1_
- __CODESPAN_0_ CAN BE SET TO UNSIGNED DATA TYPE。

# Create Table

```sql
create table table_name (
  column_name data_type,
  column_name data_type,
  column_name data_type
);
```

- __CODESPAN_0_: TABLE NAME
-_CODESPAN_0_: LISTING
-_CODESPAN_0_: DATA TYPE

# Watch rename

```sql
alter table old_name rename to new_name;
```

-_CODESPAN_0_: OLD TABLE NAME
-__CODESPAN_0_: NEW NAME

# See what tables in the database

```sql
show tables;
```


# Show table structure

```sql
desc tables;
```


# show all information in the table (select later)

```sql
select * from tables;
```

# SQL SYNTAX: COMMENT

```sql
-- 注释不会被执行
```

It's a good habit to write scripts and notes, so you don't know what you wrote for a while...

# Primary key, unique, not empty, automatic numbering

```sql
create table 表名
(
  -- 主键
  列名 数据类型 primary key,
  -- 唯一
  列名 char(20) unique,
  -- 不许为空
  列名 数据类型 not null,
  -- 自动编号
  列名 数据类型 auto_increment
);
```

# Information written to table

```sql
insert into table_name (col1, col2) values (123, "李明");
```

-_CODESPAN_0_: LISTING1
-_CODESPAN_0_: LISTED 2

# New Table Add

```sql
alter table table_name
add column new_col data_type;
```

-__CODESPAN_0_: NEW LISTING
-_CODESPAN_0_: DATA TYPE

# Table delete column

```sql
alter table 表名 drop 列名;
```

# The table changes the column type

```sql
alter table table_name modify column col_name new_data_type;
```

-__CODESPAN_0_: NEW DATA TYPE


# The table adds the main key

```sql
alter table table_name
add primary key (col_name);
```

-__CODESPAN_0_: NEW LISTING

# The table removes the primary key

```sql
alter table table_name drop primary key;
```

# Unique constraints

# # The table adds a unique constraint

```sql
alter table table_name
add constraint constraint_name unique (col_name);
```

-_CODESPAN_0_: UNIQUE BINDING NAME
-_CODESPAN_0_: LISTING

# The table removes the singularity constraint #

```sql
alter table table_name
drop index constraint_name;
```

# External keys

# # The table adds external keys

```sql
ALTER TABLE table_name
ADD CONSTRAINT fk_column_name
FOREIGN KEY (fk_column)
REFERENCES tstu(sid);
```

-_CODESPAN_0_: FOREIGN KEY NAME
-_CODESPAN_0_: EXTERNAL FORMS FOR LISTING

# The table removes the external key

```sql
alter table table_name
drop foreign key fk_name;
```

- __CODESPAN_0_: SUB-TABLE NAME
-_CODESPAN_0_: FOREIGN KEY NAME

The concept of external keys


- PARENTAL WATCH: TABLE QUOTED IN EXTERNAL KEYS. THE QUOTED COLUMN IN THE PARENT TABLE IS USUALLY THE PRIMARY KEY (PRIMARY KEY) OR THE ONLY KEY (UNIQUE). LIKE THE YELLOW TABLE ABOVE。
- Subwatch: a table containing external keys. . The external column of the sub-table indicates the primary or only key to the parent table. For example, the green table above。

# # failed to remove parent table data

- Reason: The data are cited in the sub-table。
- SOLVE: USE __CODESPAN_0_ OR REMOVE THE RECORDS FROM THE SUB-TABLE FIRST。
- CODESPAN_0... another bunch of content, a little bit. Look at [Count down three tables] (# Auto-maintenance of the reference integrity between the father and the child)。

# Here's an example of a parent, child table and external key

```sql
-- 创建父表 customers
CREATE TABLE customers (
    id INT AUTO_INCREMENT PRIMARY KEY, -- 主键，自动编号
    name VARCHAR(100) NOT NULL,        -- 客户名
    email VARCHAR(150) UNIQUE          -- 唯一的电子邮件
);

-- creating subwatches
CREATE TABLE ORERS
order number
order_date DATE NOT NULL, -- order date
control_id INT, -- external bar, associated client ID
amount DECIMAL (10, 2) -- order amount
FOREIGN KEY (customer_id) REFERENCES standards(id) - Define external keys
ON DELETE CASCADE - WHEN THE PARENT CHART IS DELETED, THE CASCADE REMOVES THE RELEVANT RECORDS OF THE SUB-TABLE
ON UPDATE CASCADE - AUTOMATICALLY UPDATE THE PARENT KEY WHEN IT IS UPDATED
(b) ;
````

1. creation of fatherhood forms:
Include columns:
id: primary key, for unique identification of customers。
name: the client's name。
email: only restricted e-mail address to prevent repetition。
2. creation of sub-watches
order_id: primary key, for the single identification order。
order_date: record the date of the order。
customer_id: external key bar for associated customers。
amount: order amount。
3. Set external keys:
`FOREIGN KEY (customer_id) REFERENCES customers(id)` denotes the id column of the child table in column _id of the parent table。
__CODESPAN_0_ WHEN THE PARENT RECORD IS DELETED, THE LINE IN THE SUB-SHEET THAT REFERS TO IT IS ALSO DELETED。
__CODESPAN_0_ WHEN THE PARENT KEY IS UPDATED, THE EXTRA-STORY COLUMN AUTOMATICALLY UPDATES。

# Modify column data type

```
ALTER TABLE 表名
MODIFY COLUMN 列名 新数据类型;

-- e.g. (reset data type not to be empty, set default)
ALTER TABLE book_table
MODIFY COLUMN BookName CHAR(100) NOT NULL DEFAULT;

-- If the column that is modified is external, the external key constraint must first be removed, then the data type modified and the external key re-added
alter table drop FOREIGN KEY;
(a) the type of new data listed in the alter table sub-table modify column;
atter table sub-form add key name FOREIGN KEY (listed) REFERENCES parent name (father listed);
````

# Modify table information, delete rows

```
-- 修改表信息
update 表名
set 列名 = 新的值
where 条件;
```

note: set you have selected an entire column, and if you want to modify the value of a single or more position, you need to limit it by where you want to modify the whole column or which of them. similar to the vertical cross-position of a coordinate point。

```sql
-- 删除行
DELETE FROM book_table
WHERE BookNumber < 200;
```

Below are some examples:

```sql
update book_table
set Price = Price * 1.2
where Publisher = "人民邮电出版社";
```

Translation into human language: ___ CODESPAN_1_value __ CODESPAN_2_ line, Price value times __ CODESPAN_3__ (i.e. 20% increase)

```sql
DELETE FROM book_table
WHERE BookNumber < 200;

DELETE FROM book_table
Whore author in;
````

# "Where's the sentence"


```
...(update 或 delete)
where Price < 50;
...(update 或 delete)
WHERE author = '王阳' or author = '刘天洋';
...(update 或 delete)
WHERE name in ('张三', '李四');
```

IF __CODESPAN_0_VALUE IS LESS THAN 50, THEN...
IF IT'S FOR WANG YANG OR LIU TIANYANG...
IF __CODESPAN_0... IS WORTH ZHANG SAN OR LI SI, THEN...
where to receive an expression written in the back, an expression will calculate a boolean value。

# HERE'S A KNOWLEDGE: SQL OPERATOR

Algorithmic operator

-_CODESPAN_0_ADDITIONAL OPERATOR
-__CODESPAN_0_DECLINING OPERATOR
-__CODESPAN_0_ MULTIPLICATION OPERATOR
-__CODESPAN_0_SEPARATE OPERATOR
- __CODESPAN_0_MODE OPERATOR

# # Compare operator #

- `=` EQUALS (ALSO AN GRANT OPERATOR)
- IT'S NOT EQUAL TO CODESPAN
- __CODESPAN_0_ LESS THAN
- __CODESPAN_0_ GREATER THAN
- __CODESPAN_0 __ LESS THAN EQUAL TO
- `>=` GREATER THAN OR EQUAL TO
- __CODESPAN_0_NULL SECURITY EQUALS NULL < = NULL, RETURN RESULT TRUE

# # logical operator #

- {\CHFFFFFF}{\CH00FFFF} {\CHFFFFFF}{\CH00FFFF} {\CHFFFFFF}{\CH00FFFF} {\CHFFFFFF}{\CH00FFFF}{\CH00FFFF} {\CHFFFFFF}{\CH00FFFF}{\CH00FFFF}
- CODESPAN, ONE CONDITION IS REAL, ALL FALSE
- __CODESPAN_0_ INVERT FAKE
- __CODESPAN_0_ RETURNS REAL ONLY ON ONE CONDITION, OTHERWISE RETURNS FALSE。

Special Operator

- __CODESPAN_0_: "Values in the list" operator to filter eligible table entries and return a "real" boolean value to the previous date or delete. For example __CODESPAN_1_returns true。
- __CODESPAN_0_ RANGES MATCH: E. G. __CODESPAN_1_RETURNS TRUE。
- __CODESPAN_0_ mode matches: __CODESPAN_1_ returns true. The percentage number here is similar to the sh wildcard。
- __CODESPAN_0_"JUDGES WHETHER THE TABLE IS NULL': __CODESPAN_1_ RETURNS TRUE。
example: see if there's a book name called xxx design xx

```sql
select * from book_table
where BookName like '%设计%';

* from book_table
where BookName like '_____;
- Five underlineds represent five words and returns the name of a book of five words length。
````

a book management library returns a book name similar to mysql database design。

so, where's the rest of it

# Auto-maintenance of the reference integrity between the parent and child watch

- **CASCEDE** CASCADES OPERATIONS: THE RELEVANT RECORDS IN THE SUB-SHEET ARE ALSO DELETED/UPDATED WHEN THE PARENT RECORD IS DELETED/UPDATED。
- **SET NULL** SETS THE EXTERNAL KEYBAR TO NULL IN THE SUB-TABLE (REQUESTS THE EXTERNAL KEYBAR TO ALLOW NULL)。
- **RESTRICT** REFUSAL TO OPERATE: NOT ALLOWED TO DELETE/UPDATE THE RECORDS CITED IN THE PARENT TABLE (WITH IMMEDIATE RETURN ERROR)。
-**NO ACTION** IS SIMILAR TO RESTRICT, BUT IS DELAYED TO CHECK FOR COMPLETENESS UNTIL THE END OF THE SERVICE。
- **SET DEFAULT** set to default, not supported by MySQL。

# SELECT STATEMENT

next to the listing, write __CODESPAN_0... and select all columns

```sql
select * from student_table
where age=(select max(age) from student_table;);
```

shows an entry with a "maximum age" in the "standard_table"

# # up and down

ASC UP, DESC DOWN。

```sql
SELECT student_name FROM student_table DESC;
```

__CODESPAN_0_ Intercept content. a Index, starting with 0, b is offset, writing is offset。

```sql
SELECT * from `学生表`
ORDER BY `学号` desc
LIMIT 0,3;
```

# How do you take the other watch

# # visible connection #

```sql
SELECT name, score --name 来自学生表，score 来自分数表
FROM stu_table -- 表一
JOIN score_table -- 表二
ON stu_table.stu_id = score_table.s_id; -- 连接条件
WHERE name = 'Jack' -- 筛选条件，后面还可以接上 AND 或 OR。
```

__CODESPAN_0_ FROM __CODESPAN_1_
__CODESPAN_0_ FROM __CODESPAN_1_

# # Invisible connection #

```sql
SELECT name, score
FROM stu_table, score_table
WHERE stu_table.stu_id = score_table.s_id
AND name = 'Jack';
```

Apparently the hidden connection is simpler, so it's recommended here。
