Section 11.2 bus interfaces and protocols

We know that M.2 is just a physical interface, which is essentially a mini-PCIe interface, which can be directly connected to physical drawing without the need for additional chips.

According to M.2 and PCIe, M.2 interfaces support 3.3V 3A, approximately 10W.


# bus, interface and protocol

We first need to distinguish three concepts: physical interfaces, bus agreements/ bus corridors and corridors/agreements. In practice, these concepts can be simplified to two, because, in essence, a corridor/agreement is equivalent to a bus/bust channel and physical bus (e.g. PCIe, RJ45, Type-C physical interface, connector, connection line, etc.) — a channel/agreement is a generic one that can mean either the sum of the two or one of the two, or both.

- Channel = protocol;
- Physical bus = physical interface;
- Physical interface: represents physical physical connection and transmission media, such as M.2, Type-C mouth, SATA, Ethernet, USB data lines, etc.;
- bus agreements/ bus corridors: refers to rules and standards used for data transmission, such as PCIe, USB, SATA, TCP/IP;
- bus/channel: bus/channel = physical bus/physical medium + bus protocol/ bus channel.


Note**
>
>** bus means the entire data transfer path and is a combination of physical bus (i.e. physical connection and transmission medium) and bus protocol (i.e. rules and standards for data transmission). **


> For example, you can use Ethernet lines to transmit HDMI digital signals. This shows the reusable nature of the physical bus.
>
>Reference to [AGREEN HDMI extensions 50 m HDMI RT RJ45 Internet portal converter] Single-line network high-resolution 1080P video transmission signal amplifiers one pair of 90811] (https://item.jd.com/10053619301.html). It uses an Ethernet line to extend the HDMI signal, and the physical medium it transmits is an Ethernet line, with RJ45.
>
> Designly, Ethernet lines usually use Ethernet protocols to transmit data, and the physical medium is a toonet line with RJ45. However, the presence of the product indicates that the physical bus can carry different types of signals. Ethernet lines as a physical medium can be used to transmit both TCP/IP data under Ethernet protocols and HDMI data via different signal coding and converters.
>
> And when the product actually transmits HDMI data, it does not use the Ethernet protocol, but is transmitted via the signal code (TMDS) under the HDMI protocol.
>
References:
>
>- [Method of transmission of HDMI signals via single web lines] (https://patents.google.com/patent/CN101572074A/zh)


The physical interface theoretically determines the upper limit and electrical performance of its load, such as the voltage, current and power that it can withstand, the IP grade, and the size size of the X. Common physical interfaces include M.2, U.2, SATA, USB (including Type-C), HDMI, DP and RJ45.

In most cases, we usually discuss the physical interface, but it is not precisely accurate to mix the physical interface with the agreement that it carries. Because any physical interface can theoretically be converted through adapters.

> For example, the Type-C interface can support various protocols such as USB2.0, USB3.0, DP, HDMI, Thunderbolt and USB PD. Therefore, M.2 interfaces can theoretically be connected to both NVMe harddisk and SATA harddisks, as well as to graphic cards, sound cards and PCI equipment on the main plate, without any drive, but may require additional 12V power supply.

The bus protocol. Modern x86 computers usually have only three bus lines:** USB**,**SATA**,**PCI**.

> For example, modern consumer type Intel processors usually support only these three bus lines directly.

The slowness of the SATA protocol or the SATA hard drive is caused by the protocol design problem and has little to do with the SATA physical interface itself. And the SATA Association has been defunct, and they think that instead of designing more new protocols that are incompatible with traditional SATA equipment, it would be better to remodel the SATA, which is the bus agreement, to let users use the PCIe hard drive or to bring the SATA hard drive directly to PCIe. The SATA is now compatible with the PCIe bus.

Because the channel that connects directly to the CPU is what we call the bus protocol, the other channel is called the normal protocol or channel. For modern processors, only USB, SATA and PCIe are directly connected to CPU. Most other devices, such as web cards, graphic cards, sound cards, cameras are usually connected to the PCIe interface.

> It needs to be noted that although these devices are connected to the PCIe bus, not all are directly connected to CPU (usually through the DMI channel on the main board).

We need to start with the structure of most of the previous X86 computers in 2010:

- CPU > Front-end bus FSB > North Bridge > PCI > South Bridge > PCI > Other equipment.

> The above PCI can also be replaced with PCIe.

But the North Bridge disappeared on the main board after PCIe and a new generation of wise and large-scale use. The North Bridge used to be responsible for high-speed equipment (e.g. memory, display) and the South Bridge for low-speed equipment (net, sound cards, cameras, etc.). The north-south bridge was connected by the PCI bus.

> In a sense, the previous PS/2 mouse, PS/2 keyboard corresponds to the straight-link CPU (North Bridge).
>
> But there's still a USB bus with a direct connection to CPU, so you can access the keyboard and mouse. Therefore, there is no reason to argue that the PS/2 interface is superior.

In the modern x86 CPU, the North Bridge is no longer visible on the main plate, but the North Bridge is not really gone. It is only integrated into the CPU, and it is handled by a number of CPU cores, from which PCIe bus lines are drawn.

What we're talking about is the PCI that went straight to CPU, which was actually the PCI that went straight to the North Bridge. Modern CPU connects to the main board by drawing foot, PCIe between CPU and the main board is called DMI by Intel, and AMD by PCI. DMI 3.0x4 corresponds to PCIe 3.0x4.

The equipment on the main board is either connected directly to the CPU or is transmitted to the CPU via the DMI bus on the mainboard.

Since the North Bridge has been integrated into the CPU, there seem to be two ways to connect.

- 1 CPU - > PCIe (PCIe on processor) - > Equipment (any equipment), which we call the direct company CPU PCIe;

- 2 CPU - > PCIe (DMI, chip set/PCIE) - > Main Board - > PCIe (or converted to other interfaces such as SATA, USB, M.2) - equipment.

Theoretically, therefore, maximum speed requires use of 1 but may affect the stability of CPUs and equipment.

At the same time, it needs to be noted that PCIe is not unlimited, as determined by the CPU specifications, and that, in general, Intel CPU may have only 20 PCIe, e.g. PCIe 3.0x20, of which 3.0 is the PCI version number and 20 is the number of corridors.

Therefore, the DMI ceiling is not unlimited, and if many PCIe x 16 slots are installed on the main board, due to the limitations of the DMI channel, this would look good, but it would not actually achieve the desired result (if fully plugged, it would certainly not meet expectations).

> ** All other devices share the DMI bus on the main board, except those directly connected to CPU. **

> In essence, there is no difference whether or not the North Bridge is integrated. > It's essentially the same. This was decided by the von Neumann structure. However, performance and efficiency have improved.

In general, for any equipment to be converted, there is a need not only for physical connectivity (connecting lines together), but also for adaptation at the software level (i.e., the driver). For example, the correct term for the so-called NVME switch USB should be USB 3.1 Gen 2 to PCIe Gen3 x2 Bridge Control. This conversion does not convert NVMe to USB, but PCIe to USB.

> Not because the installation of the driver is not required means that there are no chips in the equipment, as most of these drivers are embedded in the operating system.

In fact, the bus, interface and protocol should be strictly separate. So when we talk about the conversion of M.2 to PCIe, it's just that they're physically connected, and they don't need additional chips (and so there's no driver). However, if M.2 supports SATA, it will require a protocol conversion.

> For example, although the M.2 physical interface is the same, if the SATA hard drive is to be connected, it must be connected by converting the chip.

> Again, not strictly SATA conversion to M.2, but SATA conversion to PCIe, using PCIe Gen3 x 1 rotation 2xSATA bridge controller.

Therefore, when we refer to M.2 NVME SSD, it should be made clear that it is a PCIe hard drive, and NVME is based on the PCIe application layer protocol. Just like Intel's DMI that connects the main board to the CPU channel is essentially PCIe.

First of all, any M.2 is exactly the same as PCIe physically. No chip or level conversion is required. M.2 Interface = Mini PCIe, and this has been the case historically. However, M.2 does not have a 12V (U.2 interface support and can be considered an enhanced M.2).

Standard PCIe interfaces are powered simultaneously with 3.3 V, 12 V, maximum support 75 W. And standard M.2 highest support 3.3V 3A, or 10W.

The bus is one type of agreement, and the bus is a public channel, which is directly or indirectly compatible. There are only two kinds of physical interfaces and software protocols that really exist. It is practically irrelevant to the hierarchy of agreements. If it is hardware, it can be rotated (the hardware is also voltage, telecommunications, etc.).
。