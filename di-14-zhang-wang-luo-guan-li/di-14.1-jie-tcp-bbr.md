# SECTION 14.1 TCP STACK

THE REALIZATION OF TCP IS KNOWN AS TCP STACKS (ONE LAYER STACK, THUS REFERRED TO AS “STAMPS”)。

FreeBSD has achieved multi-tCP co-existence, and is currently being developed mainly in RACK (exploited by Nai Fei) and the base house (which has evolved by 4.4 BSD)。

# USE RACK

```
# echo "net.inet.tcp.functions_default=rack" >> /etc/sysctl.conf # 持久化，重启生效
# sysrc kld_list+="tcp_rack" # 持久化，重启生效
# kldload tcp_rack # 加载内核模块，立即生效
# sysctl net.inet.tcp.functions_default=rack # 立即生效
```

AFTER RESTARTING OR LOADING THE KERNEL MODULE, VIEW ALL AVAILABLE TCP STACKS BY COMMAND AS FOLLOWS:

```sh
# sysctl net.inet.tcp.functions_available
net.inet.tcp.functions_available:
Stack                           D Alias                            PCB count
freebsd                           freebsd                          3
rack                            * rack                             0
```

# TCP BBR

TCP BBR is a crowd control algorithm developed by Google. There are two functions:

- Full use of bandwidth
- Reduce the delay。

In general, if you use proxy software, it is recommended that the TCP BBR function be activated, with a significant effect on speed and stability. In mainland China, this technology is usually used for magic. The project was developed in FreeBSD by the Netflix team。

---|---

Without compiling kernels, you can directly configure loading:

```sh
# sysrc kld_list+="tcp_rack tcp_bbr"
```

LOAD BBR MODULES ON STARTUP。

```sh
# echo 'net.inet.tcp.functions_default=bbr' >> /etc/sysctl.conf
```

Restart:

```sh
# reboot 
```

AFTER RESTART, SEE BBR:

```sh
# sysctl net.inet.tcp.functions_default
```

TCP BBR ENABLED IF OUTPUT RESULT IS __CODESPAN_0_。


# Fragmentation and unfinished business

Please refer to, inter alia:

[@tcplog_dumper] (https://github.com/netflix/tcplog_dumper)
