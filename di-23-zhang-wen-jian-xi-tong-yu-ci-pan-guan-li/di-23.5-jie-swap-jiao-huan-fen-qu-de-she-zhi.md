# Section 23.5 Swap swap partition settings

If swap is not set when the system is installed, it can only be achieved by dd generating an exchange partition file or ZFS volume. Because neither UFS nor ZFS support narrowing the file system partition。

>** Warning**
>
>This section operation may affect the crash dump。

# traditional dd single file

dd A swap file of 8GB size (1G = 1024MB, do a number of calculation questions):

```sh
# dd if=/dev/zero of=/usr/swap0 bs=1M count=8192
8192+0 records in
8192+0 records out
8589934592 bytes transferred in 3.959893 secs (2169234270 bytes/sec)
```

OPTIONS CAN BE USED TO SHOW COMMAND PROGRESS __CODESPAN_0_

```sh
# dd if=/dev/zero of=/usr/swap0 bs=1M count=8192 status=progress
  8416919552 bytes (8417 MB, 8027 MiB) transferred 4.011s, 2098 MB/s # 此处是实时刷新的
8192+0 records in
8192+0 records out
8589934592 bytes transferred in 4.071005 secs (2110028088 bytes/sec)
```

Sets the permission to 600, i.e. only the owner has read and write permission。

```sh
# chmod 0600 /usr/swap0
```

For immediate use:

```sh
# mdconfig -a -t vnode -f /usr/swap0 -u 0 && swapon /dev/md0
```

IN ORDER TO BE VALID AFTER RESTART, ADD __CODESPAN_0_

```sh
swapfile="/usr/swap0"
```

# Use ZFS rolls as swap

```sh
# zfs create -V 8G zroot/swap
# swapon /dev/zvol/zroot/swap
```

above, the parameter __CODESPAN_0_ creates zfs rolls instead of zfs filesystems. The default name of zfs is __CODESPAN_1_。

WRITING __CODESPAN_0_ TO AUTOMOUNT:

```sh
/dev/zvol/zroot/swap none swap sw
```

AFTER WRITING, CHECK WITH __CODESPAN_0_, NO ERROR OUTPUT。

# view swap usage


```sh
root@ykla:~ # swapinfo -h
Device              Size     Used    Avail Capacity
/dev/nda0p3         2.0G       0B     2.0G     0%
```

AS YOU CAN SEE, __CODESPAN_0_ IS A SWAP PARTITION, 2G IN SIZE, USED 0。
