# Section 23.5 Swap swap partition settings

If swap is not set when the system is installed, it can only be achieved by dd generating an exchange partition file or ZFS volume. Because neither UFS nor ZFS support narrowing the file system partition.

>** Warning**
>
>This section operation may affect the crash dump.

# Traditional dd single file

dd A swap file of 8GB size (1G = 1024MB, do a number of calculation questions):

```sh '
#d if=/dev/zero of=/usr/swap0 bs=1M count=8192
8192+0 records in
8192+0 records out
8589934592 bytes converted in 3.9598993 secs (21692342270 bytes/sec)
````

To show command progress, you can use the option `status=process '

```sh '
#d if=/dev/zero of=/usr/swap0 bs=1M count=8192 status=process
841691952 bytes (8417 MB, 8027 MiB) transferred 4.011s, 2098 MB/s # here is a real-time refreshment
8192+0 records in
8192+0 records out
8589934592 bytes converted in 4.071005 secs (211002888 bytes/sec)
````

Sets the permission to 600, i.e. only the owner has read and write permission.

```sh '
#chmod 0600/usr/swap0
````

For immediate use:

```sh '
#mdconfig-a-t vnode-f/usr/swap0-u 0 & swapon/dev/md0
````

In order to remain valid after restart, add `/etc/rc.conf '

```sh '
Swapfile = "/usr/swap0"
````

# Use ZFS rolls as swap

```sh '
# zfs create - V 8G zroot/swap
#swapon /dev/zvol/zroot/swap
````

above, the parameter `-V ' creates zfs volume instead of zfs file system. The default name of zfs is `zroot ' .

Writing `/etc/fstab ' to automatically mount:

```sh '
/dev/zvol/zroot/swap none swap sw
````

After writing, check by command `mount-al ' , no error output.

# View swap usage


```sh '
# swapinfo-h
Device Size Used Avail Capability
/dev/nda0p3 2.0G 0B 2.0G 0%
````

As can be seen, `/dev/nda0p3 ' is a swap partition, 2G in size, used 0.
ã€‚