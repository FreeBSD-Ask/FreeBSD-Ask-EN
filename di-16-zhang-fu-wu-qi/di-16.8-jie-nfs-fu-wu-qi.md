SECTION 16.8 NFS SERVER

NFS CORRESPONDS TO A WEB PROTOCOL FOR SHARING FILES BETWEEN DIFFERENT OPERATING SYSTEMS。

# CONFIGURE __CODESPAN_0_

WHAT NEEDS TO BE CONFIGURED FIRST IS __CODESPAN_0, WITH REFERENCE TO THE INSTRUCTIONS OF THE DOCUMENT AND A LINE:

```sh
/usr/home/logs -alldirs 114.514.1919.810
```

THIS INDICATES THAT ALL SUBDIRECTORIES UNDER __CODESPAN_0 ARE SHARED ON __CODESPAN_1_ THIS CLIENT。

Services

- INSERT IN ___CODESPAN_0_:

```sh
rpcbind_enable="YES"
nfs_server_enable="YES"
mountd_enable="YES"
```

- start nfsd:

```sh
# service nfsd start
```

- reload mountaind, read profile:

```sh
# service mountd reload
```

- GO TO PRE-CONFIGURED CLIENT, OPEN NFS:

```sh
# sysrc nfs_client_enable="YES"
```

# Mount

```sh
# mount server:/usr/home/logs /mnt
```

# Fragmentation and unfinished business

# # The shared directory uses soft links to cause mistakes


```sh
mount.nfs: access denied by server while mounting
```

THE HINT __CODESPAN_0_ HAS NOTHING TO DO WITH THE USER 'S PERMISSIONS. IT IS REJECTED BY THE NFS SERVER WHEN MOUNTED. SO THE REAL PROBLEM IS THAT THE SERVICE IS NOT PROPERLY CONFIGURED。


- View system logs:

```sh
# cat /var/log/messages
```

A record of this:

```sh
bad exports list line '/home/logs': symbolic link in export path or statfs failed
```

This record explains why a soft link exists in the __CODESPAN_0_ path and cannot be shared. Unlike some Linux releases, in FreeBSD, CODESPAN_1 is a soft link to __CODESPAN_2_。

Note**
>
>In the new version of FreeBSD (14.0 et al.), __CODESPAN_0 [not anymore] (https://cgit.freebsd.org/src/committee/?id=bb2d2ce4220) `/usr/home` soft link should no longer exist。

- And then..

```sh
/home/logs -alldirs 114.514.1919.810
```

there shall be substituted:

```sh
/usr/home/logs -alldirs 114.514.1919.810
```

- reload mountaind, read profile:

```sh
service mountd reload
```

- Back to the client, run:

```sh
mount server:/usr/home/logs /mnt
```

Successfully mounted。

# References

[31.3. NETWORK FILE SYSTEM (NFS)] (https://handbook.bsdcn.org/di-31-zhang-wang-luo-fu-vu-qi/31.3.-wang-luo-wen-jian-xi-tong-nfs.html)
- [mount_nfs --mount NFS file systems] (https://www.freebsd.org/cgi/man.cgi?mount_nfs8)
- [Li Jin-jung] (https://note.lishouzhong.com/article/translation/sitemap-index.html)
- [problems incorporated in number freebsd nfs]

